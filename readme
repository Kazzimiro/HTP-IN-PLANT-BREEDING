# Análise de Dados de Fenotipagem de Alto Rendimento (HTP) com R

![Linguagem](https://img.shields.io/badge/Linguagem-R-blue?style=for-the-badge&logo=r)

## Visão Geral

> **Nota Importante:** Este repositório foi desenvolvido como parte da avaliação da disciplina "HTP in Plant Breeding", ministrada pelos professores Roberto Fritsche-Neto e Julio Cesar DoVale. O código-base, os dados e a metodologia foram fornecidos pelo **Prof. Roberto Fritsche-Neto**, sendo este trabalho uma implementação e adaptação para a resolução dos exercícios propostos (Homework 2 e 3).

Este repositório apresenta um pipeline em R para análise de dados de **Fenotipagem de Alto Rendimento (HTP)** em experimentos de melhoramento de plantas. O objetivo é automatizar a coleta de dados fenotípicos a partir de ortomosaicos e nuvens de pontos gerados por VANTs (drones).

## Índice

- [Funcionalidades Principais](#funcionalidades-principais)
- [Tecnologias Utilizadas](#tecnologias-utilizadas)
- [Pré-requisitos e Instalação](#pré-requisitos-e-instalação)
- [Estrutura de Dados Esperada](#estrutura-de-dados-esperada)
- [Como Utilizar](#como-utilizar)
- [Autoria e Contato](#autoria-e-contato)
- [Direitos Autorais e Uso](#direitos-autorais-e-uso)

## Funcionalidades Principais

O pipeline implementa as seguintes análises:

1.  **Extração de Índices de Vegetação e Cobertura de Dossel:**
    - Recorta o ortomosaico geral para cada parcela individual.
    - Aplica uma máscara para remover o solo, utilizando o limiar de Otsu sobre o índice de vegetação ExG (*Excess Green*).
    - Calcula índices de vegetação (ex: NGRDI, TGI) e a percentagem de cobertura do dossel para cada parcela.

2.  **Contagem de Plantas (Estande):**
    - Utiliza imagens de estágios fenológicos iniciais.
    - Realiza a segmentação da vegetação e aplica algoritmos de análise de objetos para identificar e contar o número de plantas em cada parcela.

3.  **Estimativa de Altura de Plantas:**
    - Processa nuvens de pontos (`.laz`) de dois momentos: solo exposto (Dia 0) e com a cultura estabelecida (ex: Dia 60).
    - Calcula a altura da planta subtraindo a elevação do solo (mediana, P50) da elevação do topo do dossel (percentil 90), um método robusto contra *outliers*.

O processamento é otimizado para performance através de computação paralela.

## Tecnologias Utilizadas

Este projeto foi desenvolvido inteiramente em **R** e faz uso dos seguintes pacotes principais:

-   `raster` e `sp`: para manipulação de dados geoespaciais (ortomosaicos e shapefiles).
-   `lidR` e `rlas`: para processamento e análise de nuvens de pontos LiDAR.
-   `pliman` e `EBImage`: para análise de imagem e segmentação.
-   `foreach` e `doParallel`: para implementação de processamento paralelo e ganho de performance.
-   `data.table`: para leitura e manipulação eficiente de grandes arquivos de dados.

## Pré-requisitos e Instalação

Para executar este script, você precisará ter o [R](https://cran.r-project.org/) e, preferencialmente, o [RStudio Desktop](https://posit.co/download/rstudio-desktop/) instalados.

Com o R aberto, execute o comando abaixo para instalar todas as bibliotecas necessárias:

```r
install.packages(c(
  "raster", 
  "EBImage", 
  "foreach", 
  "doParallel", 
  "sp", 
  "tidyr", 
  "pliman", 
  "data.table", 
  "rlas", 
  "lidR"
))
